<!--pages/product/product.wxml-->
<view class="container">
  <!-- 产品图片 -->
  <view class="product-image-container">
    <image 
      class="product-image"
      src="{{product.imageUrl}}"
      mode="aspectFit"
      binderror="onImageError"
      bindtap="onImageTap"
    />
  </view>

  <!-- 产品信息卡片 -->
  <view class="product-info-card">
    <view class="product-title">{{product.name || '产品名称'}}</view>
    
    <view wx:if="{{product.price}}" class="product-price">¥{{product.price}}</view>
    
    <view class="product-details">
      <view wx:if="{{product.productCode || product.id}}" class="detail-item">
        <text class="detail-label">商品编号：</text>
        <text class="detail-value">{{product.productCode || product.id}}</text>
      </view>
      
      <view wx:if="{{product.brandName}}" class="detail-item">
        <text class="detail-label">品牌/厂商：</text>
        <text class="detail-value">{{product.brandName}}</text>
      </view>
      
      <view wx:if="{{product.spec}}" class="detail-item">
        <text class="detail-label">规格：</text>
        <text class="detail-value">{{product.spec}}</text>
      </view>
      
      <view wx:if="{{product.unit}}" class="detail-item">
        <text class="detail-label">单位：</text>
        <text class="detail-value">{{product.unit}}</text>
      </view>
      
      <view wx:if="{{product.categoryNameFromDict}}" class="detail-item">
        <text class="detail-label">分类：</text>
        <text class="detail-value">{{product.categoryNameFromDict}}</text>
      </view>
    </view>
    
    <view wx:if="{{product.description}}" class="product-description">
      <view class="detail-label">产品描述：</view>
      <text class="description-text">{{product.description}}</text>
    </view>
  </view>

  <!-- 操作按钮 -->
  <view class="action-buttons">
    <button 
      class="btn btn-secondary btn-share"
      open-type="share"
    >
      分享产品
    </button>
    <button 
      class="btn btn-primary btn-contact"
      bindtap="onContact"
    >
      联系客服
    </button>
  </view>

  <!-- 相关产品推荐 -->
  <view wx:if="{{relatedProducts.length > 0}}" class="related-section">
    <view class="section-title">相关产品推荐</view>
    <scroll-view class="related-scroll" scroll-x="true">
      <view 
        wx:for="{{relatedProducts}}" 
        wx:key="id"
        class="related-item"
        bindtap="onRelatedProductTap"
        data-product="{{item}}"
      >
        <image 
          class="related-image"
          src="{{item.imageUrl}}"
          mode="aspectFill"
          lazy-load="true"
        />
        <view class="related-name">{{item.name}}</view>
        <view wx:if="{{item.price}}" class="related-price">¥{{item.price}}</view>
      </view>
    </scroll-view>
  </view>

  <!-- 加载状态 -->
  <view wx:if="{{loading}}" class="loading-state">
    <text>加载中...</text>
  </view>

  <!-- 错误状态 -->
  <view wx:if="{{error}}" class="error-state">
    <text>{{error}}</text>
    <button class="btn btn-primary" bindtap="onRetry">重试</button>
  </view>
</view>

<!-- 图片预览遮罩 -->
<view wx:if="{{showImagePreview}}" class="image-preview-overlay" bindtap="onCloseImagePreview">
  <image 
    class="preview-image"
    src="{{product.imageUrl}}"
    mode="aspectFit"
  />
  <view class="preview-close" bindtap="onCloseImagePreview">×</view>
</view>